let pokemonRepository = (function () {
  let e = [],
    t = "https://pokeapi.co/api/v2/pokemon/?limit=151";
  document.querySelector(".modal-container");
  function n(t) {
    e.push(t);
  }
  function s(e) {
    d(e).then(function () {
      !(function (e) {
        let t = $(".modal-body"),
          n = $(".modal-title");
        t.empty(), n.empty();
        let s = (function (e) {
            let t,
              n = e.detailsUrl;
            t = n.indexOf("pokemon");
            let i,
              s = n.substr(t + 8),
              o = s.slice(0, s.length - 1);
            i = 1 === o.length ? "00" + o : 2 === o.length ? "0" + o : o;
            return i;
          })(e),
          o = a(e.name),
          r = $("<h2>#" + s + "  " + o + "</h2>");
        let d = 10 * e.height,
          c = 0.3937 * d;
        c = Math.round(10 * c) / 10;
        let l = document.createElement("span");
        (l.innerText = `Height: ${d} cm`), l.classList.add("pokemon-height");
        let p = document.createElement("span"),
          m = document.createTextNode("inch");
        p.appendChild(m),
          (p.title = "inch"),
          p.classList.add("inch-btn"),
          p.classList.add("active");
        let u = document.createElement("span"),
          g = document.createTextNode("cm");
        u.appendChild(g),
          (u.title = "cm"),
          u.classList.add("cm-btn"),
          u.classList.add("non-active"),
          p.addEventListener("click", function () {
            u.classList.add("active"),
              p.classList.remove("active"),
              p.classList.add("non-active"),
              u.classList.remove("non-active"),
              (l.innerText = "Height: " + c + " in");
          }),
          u.addEventListener("click", function () {
            p.classList.add("active"),
              u.classList.remove("active"),
              u.classList.add("non-active"),
              p.classList.remove("non-active"),
              (l.innerText = "Height: " + d + " cm");
          });
        let h = e.weight / 10,
          f = 2.20462262185 * h;
        f = Math.round(10 * f) / 10;
        let b = document.createElement("span");
        (b.innerText = `Weight: ${h} kg`), b.classList.add("pokemon-weight");
        let v = document.createElement("span"),
          w = document.createTextNode("lbs");
        v.appendChild(w),
          (v.title = "lbs"),
          v.classList.add("lbs-btn"),
          v.classList.add("active");
        let x = document.createElement("span"),
          k = document.createTextNode("kg");
        x.appendChild(k),
          (x.title = "kg"),
          x.classList.add("kg-btn"),
          x.classList.add("non-active"),
          v.addEventListener("click", function () {
            x.classList.add("active"),
              v.classList.remove("active"),
              v.classList.add("non-active"),
              x.classList.remove("non-active"),
              (b.innerText = "Weight: " + f + " lbs");
          }),
          x.addEventListener("click", function () {
            v.classList.add("active"),
              x.classList.remove("active"),
              x.classList.add("non-active"),
              v.classList.remove("non-active"),
              (b.innerText = "Weight: " + h + " kg");
          });
        let E = document.createElement("div"),
          A = e.types,
          L = "";
        if (A) {
          let e = a(A[0].type.name);
          for (L += `${e}`, i = 1; i < A.length; i++) {
            let e = a(A[i].type.name);
            L += `, ${e}`;
          }
        } else L = "None";
        let N = A.length < 2 ? "Type: " : "Types: ";
        (E.innerText = `${N}${L}`), E.classList.add("pokemon-types");
        let y = document.createElement("div"),
          C = e.abilities,
          S = "";
        if (C) {
          let e = a(C[0].ability.name);
          for (S += `${e}`, i = 1; i < C.length; i++) {
            let e = a(C[i].ability.name);
            S += `, ${e}`;
          }
        } else S = "None";
        let T = C.length < 2 ? "Ability: " : "Abilities: ";
        (y.innerText = `${T}${S}`), y.classList.add("pokemon-abilities");
        let D = document.createElement("img");
        (D.src = e.front), D.classList.add("pokemon-image");
        let _ = document.createElement("br"),
          F = document.createElement("button"),
          I = document.createTextNode(">");
        F.appendChild(I),
          (F.title = "Change Image"),
          F.classList.add("change-image"),
          F.classList.add("btn-secondary"),
          F.addEventListener("click", function () {
            D.src.match(e.front)
              ? (D.src = e.front1)
              : D.src.match(e.front1)
              ? (D.src = e.front2)
              : (D.src = e.front);
          });
        let U = document.createElement("button"),
          B = document.createTextNode("<");
        U.appendChild(B),
          (U.title = "Change Image"),
          U.classList.add("change-image-left"),
          U.classList.add("btn-secondary"),
          U.addEventListener("click", function () {
            D.src.match(e.front)
              ? (D.src = e.front2)
              : D.src.match(e.front2)
              ? (D.src = e.front1)
              : (D.src = e.front);
          });
        let H = document.createElement("button"),
          M = document.createTextNode("View Stats");
        H.appendChild(M),
          (H.title = "View Stats"),
          H.classList.add("view-stats"),
          H.classList.add("btn-secondary");
        let R = document.createElement("button"),
          W = document.createTextNode("Back to Info");
        R.appendChild(W),
          (R.title = "Back to Info"),
          R.classList.add("view-info"),
          R.classList.add("btn-secondary");
        let j = e.stats,
          q = j[0].base_stat,
          O = j[1].base_stat,
          P = j[2].base_stat,
          V = j[3].base_stat,
          Z = j[4].base_stat,
          z = j[5].base_stat,
          G = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        G.setAttribute("viewbox", "0 0 24 24"),
          G.setAttribute("width", "450px"),
          G.setAttribute("height", "200px");
        let J = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          K = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          Q = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          X = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          Y = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          ee = document.createElementNS("http://www.w3.org/2000/svg", "g"),
          te = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          ne = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          ie = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          se = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          oe = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          ae = document.createElementNS("http://www.w3.org/2000/svg", "rect"),
          re = document.createElementNS("http://www.w3.org/2000/svg", "text"),
          de = document.createElementNS("http://www.w3.org/2000/svg", "text"),
          ce = document.createElementNS("http://www.w3.org/2000/svg", "text"),
          le = document.createElementNS("http://www.w3.org/2000/svg", "text"),
          pe = document.createElementNS("http://www.w3.org/2000/svg", "text"),
          me = document.createElementNS("http://www.w3.org/2000/svg", "text");
        function ue(e) {
          return (e + 10).toString();
        }
        let ge = q.toString(),
          he = ue(q),
          fe = O.toString(),
          be = ue(O),
          ve = P.toString(),
          we = ue(P),
          xe = V.toString(),
          ke = ue(V),
          Ee = Z.toString(),
          Ae = ue(Z),
          Le = z.toString(),
          Ne = ue(z);
        te.setAttribute("width", ge),
          te.setAttribute("height", "19"),
          te.setAttribute("y", "10"),
          re.setAttribute("x", he),
          re.setAttribute("y", "29"),
          (textNode1 = document.createTextNode("HP: " + ge)),
          re.appendChild(textNode1),
          J.appendChild(re),
          J.appendChild(te),
          G.appendChild(J);
        let ye = (function (e, t) {
          let n,
            s,
            o,
            a,
            r,
            d = t.types;
          for (i = 0; i < d.length; i++) {
            if ("normal" === (o = d[i].type.name)) {
              (n = "rgb(168, 168, 120, 0.25"),
                (s = 'url("/img/icons/normal.svg")'),
                (a = "2px solid #6D6D4E"),
                (r = "#6D6D4E");
              break;
            }
            if ("grass" === o) {
              (n = "rgb(120, 200, 80, 0.25"),
                (s = 'url("/img/icons/grass.svg")'),
                (a = "2px solid #4E8234"),
                (r = "#4E8234");
              break;
            }
            if ("bug" === o) {
              (n = "rgb(168, 184, 32, 0.25"),
                (s = 'url("/img/icons/bug.svg")'),
                (a = "2px solid #6D7815"),
                (r = "#6D7815");
              break;
            }
            if ("fire" === o) {
              (n = "rgb(240, 128, 48, 0.25"),
                (s = 'url("/img/icons/fire.svg")'),
                (a = "2px solid #9C531F"),
                (r = "#9C531F");
              break;
            }
            if ("water" === o) {
              (n = "rgb(104, 144, 240, 0.25"),
                (s = 'url("/img/icons/water.svg")'),
                (a = "2px solid #445E9C"),
                (r = "#445E9C");
              break;
            }
            if ("electric" === o) {
              (n = "rgb(248, 208, 48, 0.25"),
                (s = 'url("/img/icons/electric.svg")'),
                (a = "2px solid #A1871F"),
                (r = "#A1871F");
              break;
            }
            if ("ice" === o) {
              (n = "rgb(152, 216, 216, 0.25"),
                (s = 'url("/img/icons/ice.svg")'),
                (a = "2px solid #638D8D"),
                (r = "#638D8D");
              break;
            }
            if ("ground" === o) {
              (n = "rgb(224, 192, 104, 0.25"),
                (s = 'url("/img/icons/ground.svg")'),
                (a = "2px solid #927D44"),
                (r = "#927D44");
              break;
            }
            if ("flying" === o) {
              (n = "rgb(168, 144, 240, 0.25"),
                (s = 'url("/img/icons/flying.svg")'),
                (a = "2px solid #6D5E9C"),
                (r = "#6D5E9C");
              break;
            }
            if ("ghost" === o) {
              (n = "rgb(112, 88, 152, 0.25"),
                (s = 'url("/img/icons/ghost.svg")'),
                (a = "2px solid #493963"),
                (r = "#493963");
              break;
            }
            if ("rock" === o) {
              (n = "rgb(184, 160, 56, 0.25"),
                (s = 'url("/img/icons/rock.svg")'),
                (a = "2px solid #786824"),
                (r = "#786824");
              break;
            }
            if ("fighting" === o) {
              (n = "rgb(192, 48, 40, 0.25"),
                (s = 'url("/img/icons/fighting.svg")'),
                (a = "2px solid #7D1F1A"),
                (r = "#7D1F1A");
              break;
            }
            if ("poison" === o) {
              (n = "rgb(160, 64, 160, 0.25"),
                (s = 'url("/img/icons/poison.svg")'),
                (a = "2px solid #682A68"),
                (r = "#682A68");
              break;
            }
            if ("psychic" === o) {
              (n = "rgb(248, 88, 136, 0.25"),
                (s = 'url("/img/icons/psychic.svg")'),
                (a = "2px solid #A13959"),
                (r = "#A13959");
              break;
            }
            if ("dark" === o) {
              (n = "rgb(112, 88, 72, 0.25"),
                (s = 'url("/img/icons/dark.svg")'),
                (a = "2px solid #49392F"),
                (r = "#49392F");
              break;
            }
            if ("steel" === o) {
              (n = "rgb(184, 184, 208, 0.25"),
                (s = 'url("/img/icons/steel.svg")'),
                (a = "2px solid #787887"),
                (r = "#787887");
              break;
            }
            if ("dragon" === o) {
              (n = "rgb(112, 56, 248, 0.25"),
                (s = 'url("/img/icons/dragon.svg")'),
                (a = "2px solid #4924A1"),
                (r = "#638D8D");
              break;
            }
          }
          return (
            e.css("background-image", s),
            e.css("background-color", n),
            e.css("border", a),
            r
          );
        })(t, e);
        te.setAttribute("fill", ye),
          ne.setAttribute("fill", ye),
          ie.setAttribute("fill", ye),
          se.setAttribute("fill", ye),
          oe.setAttribute("fill", ye),
          ae.setAttribute("fill", ye),
          ne.setAttribute("width", fe),
          ne.setAttribute("height", "19"),
          ne.setAttribute("y", "40"),
          de.setAttribute("x", be),
          de.setAttribute("y", "58"),
          (textNode2 = document.createTextNode("Attack: " + fe)),
          de.appendChild(textNode2),
          K.appendChild(de),
          K.appendChild(ne),
          G.appendChild(K),
          ie.setAttribute("width", ve),
          ie.setAttribute("height", "19"),
          ie.setAttribute("y", "70"),
          ce.setAttribute("x", we),
          ce.setAttribute("y", "87"),
          (textNode3 = document.createTextNode("Defense: " + ve)),
          ce.appendChild(textNode3),
          Q.appendChild(ce),
          Q.appendChild(ie),
          G.appendChild(Q),
          se.setAttribute("width", xe),
          se.setAttribute("height", "19"),
          se.setAttribute("y", "100"),
          le.setAttribute("x", ke),
          le.setAttribute("y", "116"),
          (textNode4 = document.createTextNode("Special Attack: " + xe)),
          le.appendChild(textNode4),
          X.appendChild(le),
          X.appendChild(se),
          G.appendChild(X),
          oe.setAttribute("width", Ee),
          oe.setAttribute("height", "19"),
          oe.setAttribute("y", "130"),
          pe.setAttribute("x", Ae),
          pe.setAttribute("y", "145"),
          (textNode5 = document.createTextNode("Special Defense: " + Ee)),
          pe.appendChild(textNode5),
          Y.appendChild(pe),
          Y.appendChild(oe),
          G.appendChild(Y),
          ae.setAttribute("width", Le),
          ae.setAttribute("height", "19"),
          ae.setAttribute("y", "160"),
          me.setAttribute("x", Ne),
          me.setAttribute("y", "174"),
          (textNode6 = document.createTextNode("Speed: " + Le)),
          me.appendChild(textNode6),
          ee.appendChild(me),
          ee.appendChild(ae),
          G.appendChild(ee),
          H.addEventListener("click", function () {
            Ce.remove(),
              Se.remove(),
              E.remove(),
              y.remove(),
              H.remove(),
              U.remove(),
              D.remove(),
              F.remove(),
              t.append(G),
              t.append(R),
              t.append(_),
              t.append(U),
              t.append(D),
              t.append(F);
          }),
          R.addEventListener("click", function () {
            Te(), R.remove(), G.remove();
          }),
          G.classList.add("container");
        let Ce = document.createElement("div");
        Ce.append(l),
          Ce.append(p),
          Ce.append(u),
          Ce.classList.add("container1");
        let Se = document.createElement("div");
        function Te() {
          n.append(r),
            t.append(Ce),
            t.append(Se),
            t.append(E),
            t.append(y),
            t.append(H),
            t.append(_),
            t.append(U),
            t.append(D),
            t.append(F);
        }
        Se.append(b),
          Se.append(v),
          Se.append(x),
          Se.classList.add("container2"),
          Te();
      })(e);
    });
  }
  function o(e) {
    var t = 1;
    return (
      "-" === e[0] && ((t = -1), (e = e.substr(1))),
      function (n, i) {
        return -1 == t ? i[e].localeCompare(n[e]) : n[e].localeCompare(i[e]);
      }
    );
  }
  function a(e) {
    return e.charAt(0).toUpperCase() + e.slice(1);
  }
  function r(e, t) {
    let n = document.querySelector(".pokemon-list"),
      i = document.createElement("div");
    i.classList.add("group-list-item");
    let o = document.createElement("button");
    o.classList.add("btn"),
      o.setAttribute("data-toggle", "modal"),
      o.setAttribute("data-target", "#pokemonModal"),
      (pokemonName = a(e.name));
    document.createElement("img");
    (o.innerHTML = pokemonName),
      i.appendChild(o),
      "Descending" === t ? n.insertBefore(i, n.firstChild) : n.appendChild(i),
      (function (e, t) {
        e.addEventListener("click", function () {
          s(t);
        });
      })(o, e);
  }
  function d(e) {
    let t = e.detailsUrl;
    return fetch(t)
      .then(function (e) {
        return e.json();
      })
      .then(function (t) {
        (e.imageUrl = t.sprites.front_default),
          (e.imageUrlBack = t.sprites.front_default),
          (e.front = t.sprites.other.dream_world.front_default),
          (e.front1 = t.sprites.other.home.front_default),
          (e.front2 = t.sprites.front_default),
          (e.height = t.height),
          (e.types = t.types),
          (e.weight = t.weight),
          (e.abilities = t.abilities),
          (e.stats = t.stats);
      })
      .catch(function (e) {
        console.error(e);
      });
  }
  return {
    add: n,
    getAll: function () {
      return e;
    },
    addListItem: r,
    showDetails: s,
    loadList: function () {
      return fetch(t)
        .then(function (e) {
          return e.json();
        })
        .then(function (e) {
          e.results.forEach(function (e) {
            n({ name: e.name, detailsUrl: e.url });
          });
        })
        .catch(function (e) {
          console.error(e);
        });
    },
    loadDetails: d,
    findPokemon: function (t) {
      $(".pokemon-list").empty(),
        e.forEach((e) => {
          a(e.name).indexOf(a(t)) > -1 && r(e);
        });
    },
    sort: function () {
      let t = document.getElementById("options").value,
        n = [];
      if ("Descending" === t)
        $(".pokemon-list").empty(),
          e.forEach((e) => {
            r(e, t);
          });
      else if ("Ascending" === t)
        $(".pokemon-list").empty(),
          e.forEach((e) => {
            r(e, t);
          });
      else if ("A-Z" === t) {
        for ($(".pokemon-list").empty(), i = 0; i < e.length; i++) n.push(e[i]);
        n.sort(o("name")),
          n.forEach((e) => {
            r(e, t);
          });
      } else if ("Z-A" === t) {
        for ($(".pokemon-list").empty(), i = 0; i < e.length; i++) n.push(e[i]);
        n.sort(o("name")),
          n.reverse().forEach((e) => {
            r(e);
          });
      }
    },
  };
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
